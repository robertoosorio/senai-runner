<!DOCTYPE html>
<html class="no-js" lang="pt-br">

<head>

	<meta charset="UTF-8" />
	<title>Consumindo Web Service</title>
	
	<meta name="robots" content="noindex, nofollow" />
	<link rel="stylesheet" type="text/css" href="../css/estilos.css">

	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<!--[if lt IE 9]>
		<script src="js/html5.js" type="text/javascript"></script>
	<![endif]-->
	
</head>

<body>

	<section class="container">
		
		<div class="btn_index tituloInternas">
			<span class="label">
				<a href="javascript:history.go(-1);" class="btn_voltar">Voltar</a>
				<h1 class="text">
					Runs & Runners - Corridas
				</h1>
			</span>
		</div>

		<form action="" method="post" class="form" onsubmit="return cadastrarCorrida(this);">
			
			<input type="hidden" name="cadastro" value="1"/>
			
			<input type="text" name="nome" id="nome" placeholder="Nome da corrida">
			<input type="text" name="data" id="data" placeholder="Data da corrida">
			<input type="text" name="cidade" id="cidade" placeholder="Cidade da corrida">
			<input type="text" name="estado" id="estado" placeholder="Estado da corrida">
			
			<textarea name="descricao" id="descricao" placeholder="Descricao da corrida"></textarea>

			<input type="text" name="valor_inscricao" id="valor_inscricao" placeholder="Valor da inscrição">

			<select name="status" id="status">
				<option value="agendada">Agendada</option>
				<option value="cancelada">Cancelada</option>
			</select>

			<input type="submit" value="Enviar" class="cor2">

		</form>

		<div class="btn_index cor5 copy">
			<span class="label">
				<span class="text">Copyright &copy; 2015</span>
			</span>
		</div>

	</section>
	<!-- .container -->
	
</body>

</html>

<script type="text/javascript" src="../js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="../js/mask-input.js"></script>

<script type="text/javascript">
	
	$('#data').mask("00/00/0000");

	function cadastrarCorrida(frm){

		console.log('adicionandoCorrida');
		$.ajax({
			type: 'POST',
			contentType: 'application/json',
			url: '/webservice/runners/runs',
			dataType: "json",
			data: formToJSON(),
			success: function(data, textStatus, jqXHR){
				console.log('Criada');
				console.log('data: ' + data);
				console.log('textStatus: ' + textStatus);
				console.log(jqXHR.responseText);
				var resposta = JSON.parse(jqXHR.responseText);
				console.log(resposta.code);
				console.log(resposta.description);
			},
				error: function(jqXHR, textStatus, errorThrown){
				console.log('Erro: ' + textStatus);
				console.log('data: ' + data);
				console.log('jqXHR: ' + jqXHR);
			}
		});	

		return false;

	}

	function formToJSON() {
		var retorno = JSON.stringify({
			"nome": $('#nome').val(),
			"data": $('#data').val(),
			"cidade": $('#cidade').val(),
			"estado": $('#estado').val(),
			"descricao": $('#descricao').val(),
			"valor_inscricao": $('#valor_inscricao').val(),
			"status": $('#status').val()
		});
		return retorno;
	}

</script>
